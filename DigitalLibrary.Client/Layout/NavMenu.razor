@using DigitalLibrary.Client.Services
@inject NavigationManager Navigation
@inject UserServices UserService
@using Microsoft.AspNetCore.Components.Routing

<style>
    .navbar{
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background-color: #2c3e50;
        padding: 10px 20px;
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
        z-index: 1000;
    }
    .navbar ul {
        display: flex;
        gap: 20px; /* Khoảng cách giữa các mục */
        padding: 0;
        list-style: none;
        margin: 0;
        align-items: center;
    }

        .navbar ul:last-child {
            margin-left: auto;
        }
</style>

<nav class="navbar d-flex justify-content-between align-items-center">
    <ul class="d-flex list-unstyled mb-0">
        <li><NavLink href="/" Match="NavLinkMatch.All">🏠 Trang chủ</NavLink></li>
        <li><NavLink href="/about">📒 Giới thiệu</NavLink></li>
    </ul>
    <ul class="list-unstyled mb-0">
        @if (isLoggedIn)
        {
            <li @onclick="Logout"><NavLink href="#">🚪 Đăng xuất</NavLink></li>
        }
        else
        {
            <li @onclick="ShowLoginForm"><NavLink href="#">🔑 Đăng nhập</NavLink></li>
        }
    </ul>
</nav>

@if (isLoginFormVisible)
{
    <DigitalLibrary.Client.Pages.LoginForm OnClose="CloseLoginForm" />
}

@code {
    private bool isLoggedIn = false;
    private bool isLoginFormVisible = false;

    private void ShowLoginForm()
    {
        isLoginFormVisible = true;
    }

    protected override async Task OnInitializedAsync()
    {
        isLoggedIn = await UserService.IsLoggedIn();
    }

    private void CloseLoginForm()
    {
        isLoginFormVisible = false;
    }

    private async Task Logout()
    {
        await UserService.LogoutAsync(); // Gọi hàm logout trong UserServices
        isLoggedIn = false;
        Navigation.NavigateTo("/", forceLoad: true); // Load lại trang để cập nhật giao diện
    }
}